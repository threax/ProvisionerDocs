<h1>Handling Secrets</h1>
<p>Secrets present a large challenge for automation. Knowing them and getting them into an otherwise automated system can be challenging. You can&#39;t just commit them or add them as plaintext somewhere or else they would just be configuration. When handling secrets I ask myself a few questions.</p>
<h2>Is this secret really a secret?</h2>
<p>First make sure you are dealing with a secret. If the value is not actually secret, but just per environment configuration move it to your git backed configutation. You want as few out of band secrets as possible.</p>
<h2>Can the secret be looked up?</h2>
<p>Some secrets are provided by api calls to the services you are using. For example an Azure Storage Account will give you its connection strings and allow you to cycle them. In this case the secrets don&#39;t have to be stored, they can be looked up during provision and put into the correct place automatically.</p>
<h2>Can the secret be managed?</h2>
<p>Next if the value is really a secret can the provisioner manage it for itself? For example a database username and password does not need to be human generated. You can instead try to lookup the secret, if it does not exist create a random string and store it in the secret. Finally use the secrets to create the username and password for the db. The app can then be automatically configured by adding a connection string with this username and password to the app&#39;s key vault that is used at runtime. This category should have most all of your secrets since hopefully the provisioner can manage them all for you.</p>
<h2>External Secrets</h2>
<p>If the secret can&#39;t be managed any other way then it should be considered an external secret. Get these secrets manually and store them in a special key vault that stores manually looked up options. The provisioner can then copy these to the correct locations as if they were fully automated. External secrets can be defined as a resource that is the copied during&nbsp; a provision.</p>